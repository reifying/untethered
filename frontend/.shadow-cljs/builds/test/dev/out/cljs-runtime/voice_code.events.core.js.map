{"version":3,"sources":["voice_code/events/core.cljs"],"mappings":"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","names":["re_frame.core.reg_event_db","_","voice-code.db/default-db","re_frame.core.reg_event_fx","p__11972","map__11973","cljs.core/--destructure-map","cljs.core.get","db","cljs.core.merge","p__11978","vec__11979","cljs.core.nth","session-id","cljs.core.assoc","p__11985","p__11986","map__11987","vec__11988","p__11995","vec__11996","loading?","cljs.core/assoc-in","p__11999","vec__12000","error","p__12007","vec__12008","text","p__12013","vec__12014","cljs.core.update_in","cljs.core/dissoc","p__12017","vec__12018","key","value","p__12022","p__12023","map__12025","vec__12026","p__12032","vec__12033","cljs.core.update","cljs.core/conj","p__12039","vec__12040","cljs.core/disj","p__12044","vec__12045","message","cljs.core.fnil","p__12049","vec__12050","messages","cljs.core/into","p__12053","vec__12054","p__12061","vec__12062","session","p__12070","vec__12071","sessions","cljs.core.reduce","p__12075","vec__12076","updates","cljs.core/merge","p__12080","vec__12081","p__12084","vec__12086","seq__12087","cljs.core/seq","first__12088","cljs.core/first","cljs.core/next","path","f","args","cljs.core.apply","cljs.core/update-in"],"sourcesContent":["(ns voice-code.events.core\n  \"Core re-frame events for app initialization and general state management.\"\n  (:require [re-frame.core :as rf]\n            [voice-code.db :as db]))\n\n;; ============================================================================\n;; Initialization\n;; ============================================================================\n\n(rf/reg-event-db\n :initialize-db\n (fn [_ _]\n   db/default-db))\n\n(rf/reg-event-fx\n :app/initialize\n (fn [{:keys [db]} _]\n   {:db (merge db/default-db db)\n    :dispatch-n [[:persistence/load-settings]\n                 [:persistence/load-api-key]]}))\n\n;; ============================================================================\n;; Session Selection\n;; ============================================================================\n\n(rf/reg-event-db\n :sessions/set-active\n (fn [db [_ session-id]]\n   (assoc db :active-session-id session-id)))\n\n(rf/reg-event-fx\n :sessions/select\n (fn [{:keys [db]} [_ session-id]]\n   {:db (assoc db :active-session-id session-id)\n    :dispatch [:session/subscribe session-id]}))\n\n;; ============================================================================\n;; UI State\n;; ============================================================================\n\n(rf/reg-event-db\n :ui/set-loading\n (fn [db [_ loading?]]\n   (assoc-in db [:ui :loading?] loading?)))\n\n(rf/reg-event-db\n :ui/set-error\n (fn [db [_ error]]\n   (assoc-in db [:ui :current-error] error)))\n\n(rf/reg-event-db\n :ui/clear-error\n (fn [db _]\n   (assoc-in db [:ui :current-error] nil)))\n\n(rf/reg-event-db\n :ui/set-draft\n (fn [db [_ session-id text]]\n   (assoc-in db [:ui :drafts session-id] text)))\n\n(rf/reg-event-db\n :ui/clear-draft\n (fn [db [_ session-id]]\n   (update-in db [:ui :drafts] dissoc session-id)))\n\n;; ============================================================================\n;; Settings\n;; ============================================================================\n\n(rf/reg-event-db\n :settings/update\n (fn [db [_ key value]]\n   (assoc-in db [:settings key] value)))\n\n(rf/reg-event-fx\n :settings/save\n (fn [{:keys [db]} [_ key value]]\n   {:db (assoc-in db [:settings key] value)\n    :dispatch [:persistence/save-setting key value]}))\n\n;; ============================================================================\n;; Session Locking\n;; ============================================================================\n\n(rf/reg-event-db\n :sessions/lock\n (fn [db [_ session-id]]\n   (update db :locked-sessions conj session-id)))\n\n(rf/reg-event-db\n :sessions/unlock\n (fn [db [_ session-id]]\n   (update db :locked-sessions disj session-id)))\n\n;; ============================================================================\n;; Messages\n;; ============================================================================\n\n(rf/reg-event-db\n :messages/add\n (fn [db [_ session-id message]]\n   (update-in db [:messages session-id] (fnil conj []) message)))\n\n(rf/reg-event-db\n :messages/add-many\n (fn [db [_ session-id messages]]\n   (update-in db [:messages session-id] (fnil into []) messages)))\n\n(rf/reg-event-db\n :messages/clear\n (fn [db [_ session-id]]\n   (assoc-in db [:messages session-id] [])))\n\n;; ============================================================================\n;; Sessions\n;; ============================================================================\n\n(rf/reg-event-db\n :sessions/add\n (fn [db [_ session]]\n   (assoc-in db [:sessions (:id session)] session)))\n\n(rf/reg-event-db\n :sessions/add-many\n (fn [db [_ sessions]]\n   (reduce (fn [db session]\n             (assoc-in db [:sessions (:id session)] session))\n           db\n           sessions)))\n\n(rf/reg-event-db\n :sessions/update\n (fn [db [_ session-id updates]]\n   (update-in db [:sessions session-id] merge updates)))\n\n(rf/reg-event-db\n :sessions/remove\n (fn [db [_ session-id]]\n   (-> db\n       (update :sessions dissoc session-id)\n       (update :messages dissoc session-id))))\n\n;; ============================================================================\n;; Generic DB update (for testing)\n;; ============================================================================\n\n(rf/reg-event-db\n :db/update-in\n (fn [db [_ path f & args]]\n   (apply update-in db path f args)))\n"]}