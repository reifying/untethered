{"id":"voice-code-orchestration-5k8.2","title":"Add unit tests for :no-tasks outcome","description":"## Design Reference\n@docs/design/no-tasks-outcome.md#verification-strategy\n\n## Context\nAfter adding the :no-tasks outcome to the recipe, we need unit tests to verify the outcome is properly configured and produces the correct exit action. These tests ensure the recipe structure is correct and the orchestration logic handles the new outcome properly.\n\n## Requirements\n- [ ] Test that :no-tasks is in the :implement step's :outcomes set\n- [ ] Test that :on-outcome contains the correct :no-tasks transition\n- [ ] Test that determine-next-action returns correct exit action for :no-tasks\n- [ ] Test that recipe validation passes with new outcome\n\n## Technical Approach\nAdd tests to the existing recipes_test.clj file:\n1. implement-step-no-tasks-outcome-test: Verify outcome exists and transition is correct\n2. implement-step-no-tasks-transition-test: Verify determine-next-action behavior\n3. recipe-validates-with-no-tasks-outcome-test: Verify validation passes\n\n- Files to modify: backend/test/voice_code/recipes_test.clj\n- New files to create: none\n- Dependencies: Task 1 must complete first (recipe definition changes)\n\n## Verification\n- [ ] All new tests pass\n- [ ] All existing tests continue to pass\n- [ ] Run full test suite: clojure -M:test\n\n## Acceptance Criteria\n6. All existing tests continue to pass (plus new tests for :no-tasks)\n\n## Parallelization\nCannot be parallelized - depends on Task 1 completing first.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-28T13:57:59.524457-06:00","updated_at":"2025-12-28T13:57:59.524457-06:00","dependencies":[{"issue_id":"voice-code-orchestration-5k8.2","depends_on_id":"voice-code-orchestration-5k8.1","type":"blocks","created_at":"2025-12-28T13:57:59.525102-06:00","created_by":"daemon"}]}
{"id":"voice-code-orchestration-4ba","title":"Add model support to recipes with commit step","description":"Add ability to specify model per recipe step. Add commit step after successful code review using Haiku model.","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-28T08:51:13.107831-06:00","updated_at":"2025-12-28T09:00:46.514612-06:00"}
{"id":"voice-code-orchestration-5k8","title":"Add no-tasks outcome to implement-and-review recipe","description":"## Design Document\n@docs/design/no-tasks-outcome.md\n\n## Overview\nAdd a `:no-tasks` outcome to the implement-and-review recipe's `:implement` step. This handles the scenario where `bd ready` returns no tasks to work on, providing an explicit exit path instead of forcing the agent to use the catch-all `:other` outcome.\n\n## Acceptance Criteria\n1. `:implement` step includes `:no-tasks` in its outcomes set\n2. Selecting `:no-tasks` exits recipe with reason `\"no-tasks-available\"`\n3. Exit reason is classified as `:completed` (not `:error` or `:guardrail`) - deferred to exit-reason-classification feature\n4. iOS receives `category: \"completed\"` in the exit message - deferred to exit-reason-classification feature\n5. Human-readable message clearly states no tasks were available - deferred to exit-reason-classification feature\n6. All existing tests continue to pass","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-28T13:57:08.359587-06:00","updated_at":"2025-12-28T13:57:08.359587-06:00"}
{"id":"voice-code-orchestration-5k8.1","title":"Add :no-tasks outcome to implement step in recipe definition","description":"## Design Reference\n@docs/design/no-tasks-outcome.md#detailed-design\n\n## Context\nThe implement-and-review recipe's :implement step currently only has outcomes for when tasks exist (:complete, :blocked, :other). When bd ready returns no tasks, the agent has no appropriate outcome to select. This task adds the :no-tasks outcome with proper prompt guidance.\n\n## Requirements\n- [ ] Add :no-tasks to the :outcomes set in :implement step\n- [ ] Add :no-tasks transition to :on-outcome map with exit action and reason \"no-tasks-available\"\n- [ ] Add \"No Tasks Available\" guidance section to the :implement step prompt\n\n## Technical Approach\nModify the implement-and-review-recipe function to:\n1. Add :no-tasks to outcomes: #{:complete :no-tasks :blocked :other}\n2. Add transition: :no-tasks {:action :exit :reason \"no-tasks-available\"}\n3. Add prompt section explaining when to use :no-tasks outcome\n\n- Files to modify: backend/src/voice_code/recipes.clj\n- New files to create: none\n- Dependencies: none (this is the foundation task)\n\n## Verification\n- [ ] Recipe validation passes (validate-recipe returns nil)\n- [ ] determine-next-action returns {:action :exit :reason \"no-tasks-available\"} for :no-tasks\n- [ ] Manual verification: Read the updated recipe and confirm structure matches design\n\n## Acceptance Criteria\n1. :implement step includes :no-tasks in its outcomes set\n2. Selecting :no-tasks exits recipe with reason \"no-tasks-available\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-28T13:57:39.563357-06:00","updated_at":"2025-12-28T13:57:39.563357-06:00"}
